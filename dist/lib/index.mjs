var v=Object.defineProperty;var F=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var S=(a,e,t)=>e in a?v(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,h=(a,e)=>{for(var t in e||(e={}))A.call(e,t)&&S(a,t,e[t]);if(F)for(var t of F(e))O.call(e,t)&&S(a,t,e[t]);return a};var U=(a,e,t)=>new Promise((c,p)=>{var u=n=>{try{l(t.next(n))}catch(i){p(i)}},g=n=>{try{l(t.throw(n))}catch(i){p(i)}},l=n=>n.done?c(n.value):Promise.resolve(n.value).then(u,g);l((t=t.apply(a,e)).next())});import*as r from"react";import{ref as P,uploadBytesResumable as _,getDownloadURL as q}from"firebase/storage";import{isFunction as z}from"lodash";import{nanoid as G}from"nanoid";import{jsx as Q}from"react/jsx-runtime";var E=({payload:a,file:e})=>z(a)?a(e==null?void 0:e.name):a||G(),J=a=>{let[e,t]=r.useState(!1),[c,p]=r.useState(0),[u,g]=r.useState(""),[l,n]=r.useState(""),[i,T]=r.useState(""),[y,b]=r.useState(""),[L,N]=r.useState(),I=r.forwardRef((M,x)=>{let H=s=>{let d=Math.round(s.bytesTransferred/s.totalBytes*100);p(d)},C=s=>{t(!1),N(s),console.log(s)};return Q("input",h({type:"file",onChange:s=>{s.preventDefault();let o=s.currentTarget.files[0];b(o.name),T(o.type),t(!0);let m=a!=null&&a.includeExt?o==null?void 0:o.type.replace(/(.*)\//g,""):null,{filename:f,storage:k,path:w}=a,B=m?E({payload:f,file:o})+"."+m:E({payload:f,file:o});if(n(B),!o)return;let D=P(k,`${w}/${l}`),R=_(D,o);R.on("state_changed",H,C,()=>U(void 0,null,function*(){let $=yield q(R.snapshot.ref);g($),t(!1)}))},disabled:e,ref:x},M))});return{uploading:e,progress:c,fileURL:u,fileName:l,originalFileName:y,fileType:i,error:L,FileUploaderUI:I}},K=J;export{K as useFirebaseFileUploader};
