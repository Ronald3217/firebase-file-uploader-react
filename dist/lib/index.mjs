var A=Object.defineProperty,O=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var S=(a,e,t)=>e in a?A(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,h=(a,e)=>{for(var t in e||(e={}))_.call(e,t)&&S(a,t,e[t]);if(b)for(var t of b(e))q.call(e,t)&&S(a,t,e[t]);return a},U=(a,e)=>O(a,V(e));var y=(a,e,t)=>new Promise((g,p)=>{var c=n=>{try{l(t.next(n))}catch(i){p(i)}},u=n=>{try{l(t.throw(n))}catch(i){p(i)}},l=n=>n.done?g(n.value):Promise.resolve(n.value).then(c,u);l((t=t.apply(a,e)).next())});import*as r from"react";import{ref as z,uploadBytesResumable as G,getDownloadURL as J}from"firebase/storage";import{isFunction as K}from"lodash";import{nanoid as Q}from"nanoid";import{jsx as Y}from"react/jsx-runtime";var E=({payload:a,file:e})=>K(a)?a(e==null?void 0:e.name):a||Q(),W=a=>{let[e,t]=r.useState(!1),[g,p]=r.useState(0),[c,u]=r.useState(""),[l,n]=r.useState(""),[i,T]=r.useState(""),[x,I]=r.useState(""),[N,L]=r.useState(!1),H=r.forwardRef((M,k)=>{let w=s=>{let f=Math.round(s.bytesTransferred/s.totalBytes*100);p(f)},C=s=>{t(!1),L(s),console.log(s)};return Y("input",U(h({type:"file",onChange:s=>{s.preventDefault();let o=s.currentTarget.files[0];I(o.name),T(o.type),t(!0);let{includeExt:P,filename:d,storage:B,path:D}=a,m=P?o==null?void 0:o.type.replace(/(.*)\//g,""):null,F=m?E({payload:d,file:o})+"."+m:E({payload:d,file:o});if(n(F),!o)return;let $=z(B,`/${D}/${F}`),R=G($,o);R.on("state_changed",w,C,()=>y(void 0,null,function*(){let v=yield J(R.snapshot.ref);u(v),t(!1)}))},disabled:e},M),{ref:k}))});return{uploading:e,progress:g,fileURL:c,fileName:l,originalFileName:x,fileType:i,error:N,FileUploaderUI:H}},X=W;export{X as useFirebaseFileUploader};
