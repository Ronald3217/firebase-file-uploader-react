var $=Object.defineProperty;var U=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var b=(a,e,t)=>e in a?$(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,S=(a,e)=>{for(var t in e||(e={}))v.call(e,t)&&b(a,t,e[t]);if(U)for(var t of U(e))O.call(e,t)&&b(a,t,e[t]);return a};var y=(a,e,t)=>new Promise((g,p)=>{var c=o=>{try{l(t.next(o))}catch(i){p(i)}},u=o=>{try{l(t.throw(o))}catch(i){p(i)}},l=o=>o.done?g(o.value):Promise.resolve(o.value).then(c,u);l((t=t.apply(a,e)).next())});import*as r from"react";import{ref as P,uploadBytesResumable as _,getDownloadURL as q}from"firebase/storage";import{isFunction as z}from"lodash";import{nanoid as G}from"nanoid";import{jsx as Q}from"react/jsx-runtime";var E=({payload:a,file:e})=>z(a)?a(e==null?void 0:e.name):a||G(),J=a=>{let[e,t]=r.useState(!1),[g,p]=r.useState(0),[c,u]=r.useState(""),[l,o]=r.useState(""),[i,T]=r.useState(""),[h,L]=r.useState(""),[N,x]=r.useState(!1),H=r.forwardRef((I,M)=>{let k=s=>{let m=Math.round(s.bytesTransferred/s.totalBytes*100);p(m)},C=s=>{t(!1),x(s),console.log(s)};return Q("input",S({type:"file",onChange:s=>{s.preventDefault();let n=s.currentTarget.files[0];L(n.name),T(n.type),t(!0);let{includeExt:w,filename:d,storage:A,path:B}=a,f=w?n==null?void 0:n.type.replace(/(.*)\//g,""):null,R=f?E({payload:d,file:n})+"."+f:E({payload:d,file:n});if(o(R),!n)return;let D=P(A,`/${B}/${R}`),F=_(D,n);F.on("state_changed",k,C,()=>y(void 0,null,function*(){let V=yield q(F.snapshot.ref);u(V),t(!1)}))},disabled:e,ref:M},I))});return{uploading:e,progress:g,fileURL:c,fileName:l,originalFileName:h,fileType:i,error:N,FileUploaderUI:H}},K=J;export{K as useFirebaseFileUploader};
